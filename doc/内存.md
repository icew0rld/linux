# 内存

## 内存是什么？

RAM：随机访问存储器



## 内存包括一些什么？



## 什么是虚拟存储器？

操作系统把部分地址空间装入内存，部分留在磁盘上，并且在需要时来回交换它们。



进程地址空间

操作系统创建的抽象，作为进程可以引用的地址的集合。



用户态和内核态



什么是地址空间？

一种存储器抽象。

是进程可用于寻址内存的一套地址集合。每个进程有一个自己的地址空间，并且这个地址空间独立于其他进程的地址空间。



为什么要有地址空间？

多进程。

保护。



虚拟内存（virtual memory）

使进程在只有一部分被调入内存的情况下运行。

一种处理内存超载的方法。

每个进程的地址空间，被划分为页（page）。每一页有连续的地址范围。这些页被映射到物理内存。不是所有页都在内存中才能运行程序，当程序引用到在物理内存中的地址空间使，由硬件立刻执行必要的映射。引用到不在物理内存中的地址空间时，由操作系统负责将缺失的部分装入物理内存并重新执行失败的指令。



虚拟地址、虚拟地址空间

基址寄存器、段寄存器

内存管理单元 memory management unit，把虚拟地址映射为物理内存地址

陷阱

缺页中断

页表

TLB

多级页表

页面置换算法

NRU：not recently used

FIFO：先进先出，内核维护一个链表

​	第二次机会：如果先进的页面R位非0，表示最近被使用，则把R位置0，放到链表尾部，给它『第二次机会』

​	时钟算法：用环形链表代替，第二次机会无需修改链表

LRU：least recently used，置换未使用时间最长的

NFU：not frequently used，置换使用频率最小的，时钟中断时把页面的R位加到页面的计数器上，这个计数器就是频率。NFU是LRU的近似。

​	**老化算法**

工作集算法：工作集是进程最近k次访问的页面的集合

​	**工作集时钟算法**



分段

大小可变的二维地址空间。地址空间被划分为逻辑上独立的。是和分页同级别的另一种地址空间。





空闲内存管理

位图

空闲区链表

伙伴分配器

slab分配器



h

有大小限制吗？



怎么实现？



分层存储器体系（memory hierarchy）



存储管理器（memory manager）

操作系统中管理分层存储器体系的部分。它的任务是有效管理内存。



BIOS：基本输入输出系统，在ROM中的系统



